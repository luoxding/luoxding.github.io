<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>利用 Hugo 和 Github Pages 创建静态博客并实现自动部署 | Laoluo's Blog</title>
<meta name=keywords content="Hugo,Github Pages,Github Actions,CI/CD"><meta name=description content="本文主要介绍了如何利用 Hugo 和 Github Pages 创建静态博客，并利用 Github Actions 实现博客的自动部署。"><meta name=author content="James"><link rel=canonical href=http://localhost:1313/hugo-github-pages-blog/><link crossorigin=anonymous href=/assets/css/stylesheet.d2540e28ae03a9ed42429ed74228412a18d4ea29c639e31e4f0b1512e252624f.css integrity="sha256-0lQOKK4Dqe1CQp7XQihBKhjU6inGOeMeTwsVEuJSYk8=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=http://localhost:1313/icons/linux.png><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/hugo-github-pages-blog/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.7.0/style.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fontsource/cascadia-code@4.2.1/index.min.css><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><meta property="og:title" content="利用 Hugo 和 Github Pages 创建静态博客并实现自动部署"><meta property="og:description" content="本文主要介绍了如何利用 Hugo 和 Github Pages 创建静态博客，并利用 Github Actions 实现博客的自动部署。"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/hugo-github-pages-blog/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-08-19T15:04:55+08:00"><meta property="article:modified_time" content="2021-08-19T15:04:55+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="利用 Hugo 和 Github Pages 创建静态博客并实现自动部署"><meta name=twitter:description content="本文主要介绍了如何利用 Hugo 和 Github Pages 创建静态博客，并利用 Github Actions 实现博客的自动部署。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"利用 Hugo 和 Github Pages 创建静态博客并实现自动部署","item":"http://localhost:1313/hugo-github-pages-blog/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"利用 Hugo 和 Github Pages 创建静态博客并实现自动部署","name":"利用 Hugo 和 Github Pages 创建静态博客并实现自动部署","description":"本文主要介绍了如何利用 Hugo 和 Github Pages 创建静态博客，并利用 Github Actions 实现博客的自动部署。\n","keywords":["Hugo","Github Pages","Github Actions","CI/CD"],"articleBody":"本文主要介绍了如何利用 Hugo 和 Github Pages 创建静态博客，并利用 Github Actions 实现博客的自动部署。\n背景介绍 Hugo Hugo 是一个用 Go 编写的静态网站生成器，Hugo 一般只需几秒钟就能生成一个网站（每页少于 1 毫秒），被称为“世界上最快的网站构建框架”。这也使 Hugo 大受欢迎，成为最热门的静态网站生成器之一，被广泛采用。\n静态博客最常用的两个框架就是 Hugo 和 Hexo。由于 Hexo 是由 Node.js 编写，在文章数量较大之后就需要比较长的编译时间，因此由于性能考虑我们采用 Hugo 作为我们博客的框架。\nGithub Pages GitHub Pages 是 GitHub 提供的一个免费网页寄存服务，可以用于存放静态网页，包括博客、项目文档甚至整本书。利用 Github Pages 部署静态博客，就可以免去部署服务器的费用，减少成本。不过，静态博客由于没有数据库，因此在后台管理方面就不如动态博客（如 WordPress 等）方便。\nGithub Actions Github Actions 提供了免费的 CI/CD 功能，能够帮助我们自动完成软件开发周期内的任务。 GitHub Actions 是事件驱动的，意味着可以在指定事件发生后运行一系列命令。 例如，每次有人为仓库创建拉取请求时，都可以自动运行命令来执行软件测试脚本。\n利用 Github Actions，我们就可以实现博客的自动部署。每当我们对仓库完成 push 操作时，Github 就能自动进行编译并完成静态文件的部署。\n博客建立 我们首先下载 Hugo，推荐下载 extended 版本。解压并设置好环境变量后，打开终端，输入\nhugo new site Blog 这样就建立了一个新的博客。\n我们可以建立一篇新的文章。\nhugo new posts/first-post/index.md 这样，就会在 Blog/content/posts/first-post/下生成一个名为 index.md的文件。\n编写完博客之后，我们可以通过\nHugo server -D 来对网站进行实时预览，以及通过\nHugo 来将网站进行编译。\n选择主题 我推荐的主题是 PaperMod 主题。我们可以通过此命令来安装该主题\ngit submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth=1 而当我们重新 clone 我们的仓库时，如果主题没有自动下载，需要运行以下命令\ngit submodule update --init --recursive # needed when you reclone your repo (submodules may not get cloned automatically) 具体的配置可以参照仓库的 Wiki，这里简单介绍以下如何添加归档和搜索页面。\n在 Blog/contend/ 下创建 archives.md 和 search.md，内容分别为：\narchives.md\n--- title: \"Archive\" layout: \"archives\" url: \"/archives\" summary: \"archives\" --- search.md\n--- title: \"Search\" layout: \"search\" summary: \"search\" --- 然后修改 config.yml 配置文件，将 menu 部分改为\nmenu: main: - name: Archives url: archives weight: 10 - name: Categories url: categories/ weight: 20 - name: Tags url: tags/ weight: 30 - name: Search url: search/ weight: 40 这样博客就有了归档和搜索页面。\n建立远程仓库 我们在 Github 上建立名为 username.github.io 的仓库，然后将本地的博客与远程仓库的 source 分支对应，添加 .gitignore 文件后就可以将文件都推送到该分支了。而 main 分支作为我们 Pages 展示的分支，暂时留空，它将在后面由 Github Actions 自动生成并部署。\n使用脚本简化操作 我们可以通过 脚本来简化博客的操作。\n首先是部署的脚本 deploy.sh\n#!/bin/ # 添加所有修改 git add . # 设置提交说明，格式为 Site updated: 2006-01-02 15:04:05 time=$(date \"+%Y-%m-%d %H:%M:%S\") commit=\"Site updated:\"$time echo $commit # 提交 git commit -m \"$commit\" # 推送到source分支上 git push origin source 然后修改 .zshrc 文件，添加几个简写\n# Hugo export BLOG_HOME=\"$HOME/Blog\" alias hs=\"cd $BLOG_HOME \u0026\u0026 hugo server -D\" alias hd=\"cd $BLOG_HOME \u0026\u0026 sh deploy.sh\" alias hb=\"cd $BLOG_HOME \u0026\u0026 rm -rf public/* \u0026\u0026 hugo\" hn() { cd $BLOG_HOME \u0026\u0026 hugo new posts/$1/index.md } 这样，我们就可以通过 hs 实现预览，通过 hb 实现博客编译，通过 hd 实现博客部署，通过 hn new-post 创建新的博文了。\nGithub Actions 自动部署 首先，我们要先在 Github 上申请一个 personal access token。选择 Token 的作用域时可以根据需要选择，也可以直接全选。完成后 Github 会提供一个 Token，注意该 Token 只会出现一次，我们需要保存好，如果忘记就只能重新申请了。\n插一句题外话，实际上，由于 Github 现在已经不再支持密码验证，当我们进行 push 操作时同样也需要 Token。为了简便，我们可以将仓库的远程地址换成 https://@github.com/user/repo.git，这样在 push 时就不需要要求验证了。\n然后在远程仓库的 Settings/Secrets 中添加你的 Personal access token。\n最后在本地仓库中新建 Blog/.github/workflows/gh-pages.yml 文件\nname: github pages on: push: branches: - source # Set a branch to deploy jobs: deploy: runs-on: ubuntu-20.04 steps: - uses: actions/checkout@v2 with: submodules: recursive # Fetch Hugo themes (true OR recursive) fetch-depth: 0 # Fetch all history for .GitInfo and .Lastmod - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: \"latest\" extended: true - name: Build run: hugo --minify - name: Deploy uses: peaceiris/actions-gh-pages@v3 with: github_token: ${{ secrets.ACTIONS_TOKEN }} publish_dir: ./public publish_branch: main cname: your_domain 注意需要将 github_token 的名称改为你仓库中 token 的名字，并将 cname 换成你自己的域名，如不需要更换也可以删除。更换后也需要到域名的 DNS 管理处添加 CNAME 到 username.github.io。\n并且，Github 还会自动为我们申请 SSL 证书，我们可以到仓库的 Github Pages 设置页面打开 HTTPS 访问。\n这样，每当我们将源码推送到 source 分支后，Github 就会自动就编译后的静态文件部署到 main 分支并发布到 Github Pages 中了。\n从远程仓库下载 当我们更换了一台新的电脑或是本地仓库被损坏时，可以从远程仓库中下载博客。为了下载博客的主题，需要添加 --recurse-submodules 参数。\ngit clone username.github.io --recurse-submodules ","wordCount":"426","inLanguage":"en","datePublished":"2021-08-19T15:04:55+08:00","dateModified":"2021-08-19T15:04:55+08:00","author":{"@type":"Person","name":"James"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/hugo-github-pages-blog/"},"publisher":{"@type":"Organization","name":"Laoluo's Blog","logo":{"@type":"ImageObject","url":"http://localhost:1313/icons/linux.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Laoluo's Blog (Alt + H)">Laoluo's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=http://localhost:1313/about/ title=关于><span>关于</span></a></li><li><a href=http://localhost:1313/archives title=归档><span>归档</span></a></li><li><a href=http://localhost:1313/categories/ title=分类><span>分类</span></a></li><li><a href=http://localhost:1313/tags/ title=标签><span>标签</span></a></li><li><a href=http://localhost:1313/manual/ title=速查><span>速查</span></a></li><li><a href=http://localhost:1313/links/ title=链接><span>链接</span></a></li><li><a href=http://localhost:1313/search/ title=🔍><span>🔍</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>利用 Hugo 和 Github Pages 创建静态博客并实现自动部署</h1><div class=post-meta><span title='2021-08-19 15:04:55 +0800 CST'>August 19, 2021</span>&nbsp;·&nbsp;James</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e8%83%8c%e6%99%af%e4%bb%8b%e7%bb%8d aria-label=背景介绍>背景介绍</a><ul><li><a href=#hugo aria-label=Hugo>Hugo</a></li><li><a href=#github-pages aria-label="Github Pages">Github Pages</a></li><li><a href=#github-actions aria-label="Github Actions">Github Actions</a></li></ul></li><li><a href=#%e5%8d%9a%e5%ae%a2%e5%bb%ba%e7%ab%8b aria-label=博客建立>博客建立</a></li><li><a href=#%e9%80%89%e6%8b%a9%e4%b8%bb%e9%a2%98 aria-label=选择主题>选择主题</a></li><li><a href=#%e5%bb%ba%e7%ab%8b%e8%bf%9c%e7%a8%8b%e4%bb%93%e5%ba%93 aria-label=建立远程仓库>建立远程仓库</a></li><li><a href=#%e4%bd%bf%e7%94%a8%e8%84%9a%e6%9c%ac%e7%ae%80%e5%8c%96%e6%93%8d%e4%bd%9c aria-label=使用脚本简化操作>使用脚本简化操作</a></li><li><a href=#github-actions-%e8%87%aa%e5%8a%a8%e9%83%a8%e7%bd%b2 aria-label="Github Actions 自动部署">Github Actions 自动部署</a></li><li><a href=#%e4%bb%8e%e8%bf%9c%e7%a8%8b%e4%bb%93%e5%ba%93%e4%b8%8b%e8%bd%bd aria-label=从远程仓库下载>从远程仓库下载</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>本文主要介绍了如何利用 Hugo 和 Github Pages 创建静态博客，并利用 Github Actions 实现博客的自动部署。</p><h2 id=背景介绍>背景介绍<a hidden class=anchor aria-hidden=true href=#背景介绍>#</a></h2><h3 id=hugo>Hugo<a hidden class=anchor aria-hidden=true href=#hugo>#</a></h3><p>Hugo 是一个用 Go 编写的静态网站生成器，Hugo 一般只需几秒钟就能生成一个网站（每页少于 1 毫秒），被称为“世界上最快的网站构建框架”。这也使 Hugo 大受欢迎，成为最热门的静态网站生成器之一，被广泛采用。</p><p>静态博客最常用的两个框架就是 Hugo 和 Hexo。由于 Hexo 是由 Node.js 编写，在文章数量较大之后就需要比较长的编译时间，因此由于性能考虑我们采用 Hugo 作为我们博客的框架。</p><h3 id=github-pages>Github Pages<a hidden class=anchor aria-hidden=true href=#github-pages>#</a></h3><p>GitHub Pages 是 GitHub 提供的一个免费网页寄存服务，可以用于存放静态网页，包括博客、项目文档甚至整本书。利用 Github Pages 部署静态博客，就可以免去部署服务器的费用，减少成本。不过，静态博客由于没有数据库，因此在后台管理方面就不如动态博客（如 WordPress 等）方便。</p><h3 id=github-actions>Github Actions<a hidden class=anchor aria-hidden=true href=#github-actions>#</a></h3><p>Github Actions 提供了免费的 CI/CD 功能，能够帮助我们自动完成软件开发周期内的任务。 GitHub Actions 是事件驱动的，意味着可以在指定事件发生后运行一系列命令。 例如，每次有人为仓库创建拉取请求时，都可以自动运行命令来执行软件测试脚本。</p><p>利用 Github Actions，我们就可以实现博客的自动部署。每当我们对仓库完成 push 操作时，Github 就能自动进行编译并完成静态文件的部署。</p><h2 id=博客建立>博客建立<a hidden class=anchor aria-hidden=true href=#博客建立>#</a></h2><p>我们首先下载 <a href=https://github.com/gohugoio/hugo/releases>Hugo</a>，推荐下载 extended 版本。解压并设置好环境变量后，打开终端，输入</p><pre tabindex=0><code>hugo new site Blog
</code></pre><p>这样就建立了一个新的博客。</p><p>我们可以建立一篇新的文章。</p><pre tabindex=0><code>hugo new posts/first-post/index.md
</code></pre><p>这样，就会在 <code>Blog/content/posts/first-post/</code>下生成一个名为 <code>index.md</code>的文件。</p><p>编写完博客之后，我们可以通过</p><pre tabindex=0><code>Hugo server -D
</code></pre><p>来对网站进行实时预览，以及通过</p><pre tabindex=0><code>Hugo
</code></pre><p>来将网站进行编译。</p><h2 id=选择主题>选择主题<a hidden class=anchor aria-hidden=true href=#选择主题>#</a></h2><p>我推荐的主题是 <a href=https://github.com/adityatelange/hugo-PaperMod>PaperMod</a> 主题。我们可以通过此命令来安装该主题</p><pre tabindex=0><code>git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth=1
</code></pre><p>而当我们重新 clone 我们的仓库时，如果主题没有自动下载，需要运行以下命令</p><pre tabindex=0><code>git submodule update --init --recursive # needed when you reclone your repo (submodules may not get cloned automatically)
</code></pre><p>具体的配置可以参照仓库的 Wiki，这里简单介绍以下如何添加归档和搜索页面。</p><p>在 <code>Blog/contend/</code> 下创建 <code>archives.md</code> 和 <code>search.md</code>，内容分别为：</p><p>archives.md</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>---
</span></span><span style=display:flex><span>title: &#34;Archive&#34;
</span></span><span style=display:flex><span>layout: &#34;archives&#34;
</span></span><span style=display:flex><span>url: &#34;/archives&#34;
</span></span><span style=display:flex><span>summary: &#34;archives&#34;
</span></span><span style=display:flex><span>---
</span></span></code></pre></div><p>search.md</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>---
</span></span><span style=display:flex><span>title: &#34;Search&#34;
</span></span><span style=display:flex><span>layout: &#34;search&#34;
</span></span><span style=display:flex><span>summary: &#34;search&#34;
</span></span><span style=display:flex><span>---
</span></span></code></pre></div><p>然后修改 <code>config.yml</code> 配置文件，将 <code>menu</code> 部分改为</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>menu</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>main</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Archives</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>url</span>: <span style=color:#ae81ff>archives</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>weight</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Categories</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>url</span>: <span style=color:#ae81ff>categories/</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>weight</span>: <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Tags</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>url</span>: <span style=color:#ae81ff>tags/</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>weight</span>: <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Search</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>url</span>: <span style=color:#ae81ff>search/</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>weight</span>: <span style=color:#ae81ff>40</span>
</span></span></code></pre></div><p>这样博客就有了归档和搜索页面。</p><h2 id=建立远程仓库>建立远程仓库<a hidden class=anchor aria-hidden=true href=#建立远程仓库>#</a></h2><p>我们在 Github 上建立名为 <code>username.github.io</code> 的仓库，然后将本地的博客与远程仓库的 <code>source</code> 分支对应，添加 <code>.gitignore</code> 文件后就可以将文件都推送到该分支了。而 <code>main</code> 分支作为我们 Pages 展示的分支，暂时留空，它将在后面由 Github Actions 自动生成并部署。</p><h2 id=使用脚本简化操作>使用脚本简化操作<a hidden class=anchor aria-hidden=true href=#使用脚本简化操作>#</a></h2><p>我们可以通过 脚本来简化博客的操作。</p><p>首先是部署的脚本 <code>deploy.sh</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># 添加所有修改</span>
</span></span><span style=display:flex><span>git add .
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置提交说明，格式为 Site updated: 2006-01-02 15:04:05</span>
</span></span><span style=display:flex><span>time<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>date <span style=color:#e6db74>&#34;+%Y-%m-%d %H:%M:%S&#34;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>commit<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Site updated:&#34;</span>$time
</span></span><span style=display:flex><span>echo $commit
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 提交</span>
</span></span><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;</span>$commit<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 推送到source分支上</span>
</span></span><span style=display:flex><span>git push origin source
</span></span></code></pre></div><p>然后修改 <code>.zshrc</code> 文件，添加几个简写</p><pre tabindex=0><code># Hugo
export BLOG_HOME=&#34;$HOME/Blog&#34;
alias hs=&#34;cd $BLOG_HOME &amp;&amp; hugo server -D&#34;
alias hd=&#34;cd $BLOG_HOME &amp;&amp; sh deploy.sh&#34;
alias hb=&#34;cd $BLOG_HOME &amp;&amp; rm -rf public/* &amp;&amp; hugo&#34;
hn() {
    cd $BLOG_HOME &amp;&amp; hugo new posts/$1/index.md
}
</code></pre><p>这样，我们就可以通过 <code>hs</code> 实现预览，通过 <code>hb</code> 实现博客编译，通过 <code>hd</code> 实现博客部署，通过 <code>hn new-post</code> 创建新的博文了。</p><h2 id=github-actions-自动部署>Github Actions 自动部署<a hidden class=anchor aria-hidden=true href=#github-actions-自动部署>#</a></h2><p>首先，我们要先在 Github 上申请一个 personal access token。选择 Token 的作用域时可以根据需要选择，也可以直接全选。完成后 Github 会提供一个 Token，注意该 Token 只会出现一次，我们需要保存好，如果忘记就只能重新申请了。</p><center><img src=assets/PAT.png width=100%></center><p>插一句题外话，实际上，由于 Github 现在已经不再支持密码验证，当我们进行 push 操作时同样也需要 Token。为了简便，我们可以将仓库的远程地址换成 <code>https://&lt;token>@github.com/user/repo.git</code>，这样在 push 时就不需要要求验证了。</p><p>然后在远程仓库的 <code>Settings/Secrets</code> 中添加你的 Personal access token。</p><center><img src=assets/secret.png width=100%></center><p>最后在本地仓库中新建 <code>Blog/.github/workflows/gh-pages.yml</code> 文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>github pages</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>source</span> <span style=color:#75715e># Set a branch to deploy</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>deploy</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-20.04</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>submodules</span>: <span style=color:#ae81ff>recursive</span> <span style=color:#75715e># Fetch Hugo themes (true OR recursive)</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>fetch-depth</span>: <span style=color:#ae81ff>0</span> <span style=color:#75715e># Fetch all history for .GitInfo and .Lastmod</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Setup Hugo</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-hugo@v2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>hugo-version</span>: <span style=color:#e6db74>&#34;latest&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>extended</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>hugo --minify</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>peaceiris/actions-gh-pages@v3</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>github_token</span>: <span style=color:#ae81ff>${{ secrets.ACTIONS_TOKEN }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>publish_dir</span>: <span style=color:#ae81ff>./public</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>publish_branch</span>: <span style=color:#ae81ff>main</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>cname</span>: <span style=color:#ae81ff>your_domain</span>
</span></span></code></pre></div><p>注意需要将 github_token 的名称改为你仓库中 token 的名字，并将 cname 换成你自己的域名，如不需要更换也可以删除。更换后也需要到域名的 DNS 管理处添加 CNAME 到 username.github.io。</p><p>并且，Github 还会自动为我们申请 SSL 证书，我们可以到仓库的 Github Pages 设置页面打开 HTTPS 访问。</p><p>这样，每当我们将源码推送到 <code>source</code> 分支后，Github 就会自动就编译后的静态文件部署到 <code>main</code> 分支并发布到 Github Pages 中了。</p><h2 id=从远程仓库下载>从远程仓库下载<a hidden class=anchor aria-hidden=true href=#从远程仓库下载>#</a></h2><p>当我们更换了一台新的电脑或是本地仓库被损坏时，可以从远程仓库中下载博客。为了下载博客的主题，需要添加 <code>--recurse-submodules</code> 参数。</p><pre tabindex=0><code>git clone username.github.io --recurse-submodules
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/hugo/>Hugo</a></li><li><a href=http://localhost:1313/tags/github-pages/>Github Pages</a></li><li><a href=http://localhost:1313/tags/github-actions/>Github Actions</a></li><li><a href=http://localhost:1313/tags/ci/cd/>CI/CD</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/hugo-blog-picture/><span class=title>« Prev</span><br><span>Hugo 博客插入图片的方法</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Laoluo's Blog</a></span>
<span>| Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><br><a href=https://beian.miit.gov.cn/ target=_blank>黔ICP备2022001597号</a></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>